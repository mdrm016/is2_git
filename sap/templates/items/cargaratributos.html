{% extends "base_general.html" %}

{% block tipo_Item_y_Atributo %}
<li><a href="/adm_proyectos/gestionar/{{ id_proyecto }}/adm_tipos_item/">Administrar Tipos de Item</a></li>
<li><a href="/adm_proyectos/gestionar/{{ id_proyecto }}/adm_tipos_atributo">Administrar Tipos de Atributo</a></li>
{% endblock %}

{% block menu %}		
<div class="menu">
	<ul>
		<li id="option1" class="active">
			<a href="/"><p>Atributos de</p> {{ itemactual.nombre }}</a>
		</li>
	</ul>
</div>
{% endblock %}

{% block botones %}
<div class="row">
	<form class="navbar-form navbar-left">
<!-- 		<a href="#"><button type="button" class="btn btn-default"><span class="glyphicon glyphicon-import"></span> Importar Fase</button></a>-->
	</form>
</div>
{% endblock %}

{% block contenido %}
<div class="content-secondary">


{% if lista_error %}
<div class="row">
    <div class="panel panel-danger">
    	<div class="panel-heading">
    		<h3 class="panel-title">Por favor verifique:</h3>
        </div>
        <div class="panel-body">
        <br>
        <ul class="list-unstyled">
           {% for campo, mensaje in lista_error %}
		<ul>
			<li><b>{{campo}}</b></li>
			{{ mensaje }}
		</ul>
  			{% endfor %}
		</ul>
        </div>
       	</div>
</div>
{% endif %}

<!-- Aca van la  lista de Proyectos.. o de Solicitudes.. o de credenciales -->
		{% if lista_valores %}

		<form enctype="multipart/form-data" action="" method="post">
			<div class="panel-group" id="accordion">
				<table align="center">
			{% for valores in lista_valores %}
				<tr>
					{% for orden, nombre, longitud, precision, maxvalue, minvalue, oblig in listaPresicionLongitud %}
							{% if valores.nombre_atributo == nombre and valores.orden == orden %}
								{% if oblig == True %}
									<td><th><label>{{ valores.nombre_atributo }} *:</label></th></td>
								{% else %}
									<td><th><label>{{ valores.nombre_atributo }}:</label></th></td>
								{% endif %}
							{% endif %}
					{% endfor %}
					{% ifequal valores.tipo_dato "Fecha" %}
						<td><input type="date" name={{forloop.counter}} class="form-control" value="{{ valores.valor_fecha }}" /> En formato Día/Mes/Año
						</td>
					{% endifequal %}
					{% ifequal valores.tipo_dato "Logico" %}
						{% ifequal valores.valor_logico "t" %}
						<td> Si<input type="radio" name="{{ forloop.counter }}" checked="checked" />
						 No<input type="radio" name="{{ forloop.counter }}" /> 
						</td>
						{% else %}
						<td> Si<input type="radio" name="{{ forloop.counter }}"  />
						 No<input type="radio" name="{{ forloop.counter }}" checked="checked" /> 
						</td>
						{% endifequal %}
					{% endifequal %}
					{% ifequal valores.tipo_dato "Archivo Externo" %}
						{% ifequal valores.valor_archivoexterno "" %}
							<td><input type="file" name="{{ forloop.counter }}" value="{{ valores.valor_archivoexterno }}" />
							</td>
						{% else %}
							<td><input type="file" name="{{ forloop.counter }}" value="{{ valores.valor_archivoexterno }}" />
							</td>
							<td><a href="{{ setting.MEDIA_URL }}{{ valores.valor_archivoexterno.url }}" name="{{ forloop.counter }}"> {{ valores.valor_archivoexterno.name }}</a>
							</td>
						{% endifequal %}
					{% endifequal %}
					{% ifequal valores.tipo_dato "Imagen" %}
						{% ifequal valores.valor_imagen "" %}
							<td><input type="file" name="{{ forloop.counter }}" value="{{ valores.valor_imagen }}" />
							</td>
						{% else %}
							<td><input type="file" name="{{ forloop.counter }}" value="{{ valores.valor_imagen }}" />
							</td>
							<td><a href="{{ setting.MEDIA_URL }}{{ valores.valor_imagen.url }}" name="{{ forloop.counter }}"><img src="{{ setting.MEDIA_URL }}{{ valores.valor_imagen.url }}" width="400" height="400"></a>
							</td>
						{% endifequal %}
					{% endifequal %}	
					{% ifequal valores.tipo_dato "Numerico" %}
					{% for orden, nombre, longitud, precision, maxvalue, minvalue, oblig in listaPresicionLongitud %}
							{% if valores.nombre_atributo == nombre and valores.orden == orden %}
						<td><input type="number" step="any" max="{{ maxvalue }}" min="{{ minvalue }}" name="{{forloop.counter}}" class="form-control" value="{{ valores.valor_texto }}"/>
						</td>
						{% endif %}
				    {% endfor %}
					{% endifequal %}
					{% ifequal valores.tipo_dato "Texto" %}
						{% for orden, nombre, longitud, precision, maxvalue, minvalue, oblig in listaPresicionLongitud %}
							{% if valores.nombre_atributo == nombre and valores.orden == orden %}
								
				    	<td>
				    		<textarea class="form-control" maxlength="{{ longitud }}" name="{{forloop.counter}}" rows="5" value="{{ valores.valor_texto }}">{{ form.data.Descripcion }}</textarea>
				    	</td>
				    	{% endif %}
				    {% endfor %}
				    {% endifequal %}
				</tr>
			{% endfor %}
		</table>
					{% csrf_token %}
					<input action="adm_proyectos/gestionar/{{ id_proyecto }}/adm_items/{{ id_fase }}/atributos/" class="btn btn-default" type="submit" value="Crear Item"/>
		
		</form>
		{% else %}
			{% if error %}
				<div class="jumbotron">
  					<div class="alert alert-danger"><h3><p align="center"><b>No se encontraron coincidencias</b></p></h3></div>
				</div>
				<div  align="center">
					<a type="button" class="btn btn-default" href="/adm_proyectos/gestionar/{{ id_proyecto }}/adm_items/{{ id_fase }}">Volver</a>
				</div>	
			{% else %}
				<div class="jumbotron">
					<div class="bs-example">
						<p class="text-warning" align="center"><small>No se encontraron Items</small></p>
					</div>
				</div>
			{% endif %}}
		{% endif %}
		

			<!-- Ininicia Modal -->
			<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
				<div class="modal-dialog">
					<div class="modal-content">
						<div class="modal-header">
							<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
							<h4 class="modal-title" id="myModalLabel">Eliminar</h4>
						</div>
						<div class="modal-body">
							Esta usted seguro de que desea eliminar el item?
						</div>
						<div class="modal-footer">
							<button type="button" class="btn btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancelar</button>
							<a id="item" href=""><button type="button" class="btn btn-danger"><span class="glyphicon glyphicon-ok"></span> Estoy Seguro</button></a>
						</div>
					</div>
				</div>
			</div>
<!-- Finaliza el Modal -->

</div>
{% endblock %}
